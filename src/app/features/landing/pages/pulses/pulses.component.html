<div class="wrap">
    <h1>Trending Topics</h1>

    <div class="row">
        <div class="col">
            <div class="top-row">
                <ng-container *ngIf="loading$ as loading$">
                    <app-input-search
                        class="top-row__search"
                        [isLoading]="(searchInFocus && (loading$ | async)) || false"
                        (handleValueChange)="onSearchValueChange($event)"
                        (focus)="onSearchFocus()"
                        (blur)="onSearchBlur()" />
                </ng-container>
                <app-category-filter
                    class="top-row__filter"
                    (selectedCategory)="onCategorySelected($event)" />
                <a
                    [routerLink]="addTopicRoute"
                    class="add-topic-button">
                    <svg-icon
                        src="assets/svg/add.svg"
                        style="height: 22px" />
                </a>
            </div>
            
            <ng-container *ngIf="loading$ as loading$">
                <app-spinner *ngIf="loading$ | async" />
            </ng-container>

            <div
                class="wrap__large-pulses"
                *ngIf="paginator$ | async as paginator"
                infiniteScroll
                [infiniteScrollDistance]="2"
                [infiniteScrollThrottle]="150"
                (scrolled)="loadMore(paginator)">
                @for (topic of paginator.items; track topic.id) {
                <app-large-pulse [pulse]="topic">
                    <app-large-pulse-footer pulse-footer>
                        <div class="pulse-footer-item">
                            <app-large-pulse-footer-row [text]="topic.author.name" />
                            <app-large-pulse-footer-row
                                icon="assets/svg/pulse.svg"
                                [text]="
                                    (topic.stats?.lastDayVotes || 0 | formatNumber) + ' in last 24h'
                                " />
                        </div>
                    </app-large-pulse-footer>
                </app-large-pulse>
                }
                <p
                    class="wrap__loading"
                    *ngIf="loading$ | async">
                    <app-loading-indicator />
                </p>
            </div>
        </div>
        <app-promote-ads />
    </div>
</div>
