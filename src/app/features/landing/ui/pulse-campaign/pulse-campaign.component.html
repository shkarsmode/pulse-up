<div class="pulse__campaign campaign" [class.campaign--no-click]="!campaign">
    @switch (campaignState) {
        @case (CampaignState.NO_GOAL) {
            <div class="campaign__no-goal">
                <svg class="campaign__no-goal-icon" viewBox="0 0 24 24" fill="none" xmlns="http://www.w3.org/2000/svg">
                    <circle cx="12" cy="12" r="10" stroke="currentColor" stroke-width="2" fill="none"/>
                    <circle cx="12" cy="12" r="6" fill="currentColor"/>
                    <circle cx="12" cy="12" r="3" fill="white"/>
                </svg>
                <div class="campaign__no-goal-title">No Active Goal</div>
                <p class="campaign__no-goal-description">
                    Champions can set goals with pledges to motivate supporters and amplify this cause.
                </p>
                <button class="campaign__propose-button" (click)="onProposeGoalClick($event)">
                    <svg viewBox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg">
                        <path d="M8 3.5V12.5M3.5 8H12.5" stroke="currentColor" stroke-width="2" stroke-linecap="round"/>
                    </svg>
                    Propose a Goal
                </button>
            </div>
        }

        @case (CampaignState.NOT_STARTED) {
            <div class="campaign__meta-row">
                <span class="campaign__badge campaign__badge--upcoming">Upcoming Goal</span>
                <span class="campaign__time-left">Starts in {{ daysLeft }} days</span>
            </div>
            <div class="campaign__title campaign__title--main">{{ currentGoal }}</div>
            <p class="campaign__description">{{ campaign?.description }}</p>

            <div class="campaign__progress-section">
                <div class="campaign__progress-header">
                    <span class="campaign__percent">0% Complete</span>
                    <span class="campaign__progress-count">0 / {{ goalTargetFormatted }}</span>
                </div>
                <div class="campaign__progress-bar">
                    <div class="campaign__progress-bar--line" style="width:0%"></div>
                </div>
            </div>

            <div class="campaign__pledge-box">
                <div class="campaign__pledge-label">The Pledge:</div>
                <div class="campaign__pledge-text">{{ currentGoalReward || '—' }}</div>
            </div>
        }

        @case (CampaignState.ACTIVE) {
            <div class="campaign__meta-row">
                <span class="campaign__badge campaign__badge--active">Active Goal</span>
                <span class="campaign__time-left">{{ daysLeft }} days left</span>
            </div>
            <div class="campaign__title campaign__title--main">{{ currentGoal }}</div>
            <p class="campaign__description">{{ campaign?.description }}</p>

            <div class="campaign__progress-section">
                <div class="campaign__progress-header">
                    <span class="campaign__percent">{{ percentLabel }}</span>
                    <span class="campaign__progress-count">{{ progressCountText }}</span>
                </div>
                <div class="campaign__progress-bar">
                    <div
                        [style.width.%]="currentGoalInPercent"
                        class="campaign__progress-bar--line"
                        style="--fill-width: {{ currentGoalInPercent }}%"
                        [class.campaign__progress-bar--not-fulled]="currentGoalInPercent < 100"></div>
                </div>
            </div>

            <div class="campaign__pledge-box">
                <div class="campaign__pledge-label">The Pledge:</div>
                <div class="campaign__pledge-text">{{ currentGoalReward || '—' }}</div>
            </div>
        }

        @case (CampaignState.COMPLETED_SUCCESS) {
            <div class="campaign__meta-row">
                <span class="campaign__badge campaign__badge--completed">Completed</span>
                <span class="campaign__time-left">{{ campaign?.endsAt | date:'MMM d, y' }}</span>
            </div>
            <div class="campaign__title campaign__title--main">{{ currentGoal }}</div>
            <p class="campaign__description">{{ campaign?.description }}</p>
            <div class="campaign__title campaign__title--success">✓ Campaign Successfully Completed</div>

            <div class="campaign__pledge-box">
                <div class="campaign__pledge-label">The Pledge:</div>
                <div class="campaign__pledge-text">{{ currentGoalReward || '—' }}</div>
            </div>
        }

        @case (CampaignState.COMPLETED_FAIL) {
            <div class="campaign__meta-row">
                <span class="campaign__badge campaign__badge--closed">Campaign Closed</span>
                <span class="campaign__time-left">Ended {{ campaign?.endsAt | date:'MMM d, y' }}</span>
            </div>
            <div class="campaign__title campaign__title--main">{{ currentGoal }}</div>
            <p class="campaign__description">{{ campaign?.description }}</p>
            <div class="campaign__title campaign__title--fail">Campaign Closed</div>

            <div class="campaign__pledge-box">
                <div class="campaign__pledge-label">The Pledge:</div>
                <div class="campaign__pledge-text">{{ currentGoalReward || '—' }}</div>
            </div>
        }
    }

    @if (campaign) {
        <a class="campaign__backed-by" [href]="campaign.sponsorLink" target="_blank" (click)="$event.stopPropagation()">
            <span class="campaign__backed-label">Backed by:</span>
            @if (campaign.sponsorLogo) {
                <img width="100" height="30" [src]="campaign.sponsorLogo" alt="sponsor logo" />
            } @else {
                <span class="campaign__backed-name">{{ campaign.sponsoredBy }}</span>
            }
        </a>
    }
</div>
