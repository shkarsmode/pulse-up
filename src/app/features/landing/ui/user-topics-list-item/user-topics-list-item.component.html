@let topic = data();

@if (topic) {
    <app-large-pulse
        [pulse]="topic"
        [showArrow]="false">
        <app-large-pulse-icon
            [src]="topic.icon"
            size="md"
            [label]="topic.title"
            ngProjectAs="card-icon">
            @if (isArchived()) {
                <app-pulse-icon-label text="Archived" />
            }
        </app-large-pulse-icon>
        <div ngProjectAs="card-heading">
            <app-large-pulse-title>
                {{ topic.title }}
            </app-large-pulse-title>
        </div>
        <app-large-pulse-description ngProjectAs="card-body">
            {{ topic.description }}
        </app-large-pulse-description>
        <div
            class="card-footer"
            ngProjectAs="card-footer">
            <div class="card-footer__left">
                <app-large-pulse-metric
                    [text]="topic.stats?.lastDayVotes || 0 | formatNumber"
                    [accent]="isVoteActive()">
                    @if (isVoteActive()) {
                        <div class="card-footer-icon-wrap card-footer-icon-wrap--active">
                            <svg-icon
                                appWavesAnimation
                                src="assets/svg/logo/logo-v2.svg"
                                ariaLabel="pulse icon"
                                class="card-footer-icon" />
                        </div>
                    } @else {
                        <svg-icon
                            src="assets/svg/pulse.svg"
                            ariaLabel="pulse icon" />
                    }
                </app-large-pulse-metric>
                <app-large-pulse-metric
                    [text]="topic.stats?.totalVotes || 0 | formatNumber"
                    icon="assets/svg/chart-simple.svg" />
            </div>
            <div class="card-footer__right">
                <app-menu [content]="menuContent">
                    <button
                        mat-icon-button
                        aria-label="Share topic">
                        <svg-icon
                            src="assets/svg/icon_share.svg"
                            ariaLabel="share icon" />
                    </button>
                </app-menu>
                <app-copy-topic-button
                    *ngIf="topicUrl() as topicUrl"
                    [topicUrl]="topicUrl" />
            </div>
        </div>
    </app-large-pulse>
}

<ng-template #menuContent>
    <div class="card-footer__socials">
        <ng-container *ngIf="topicUrl() as topicUrl">
            <app-socials-button
                [variant]="'facebook'"
                [url]="topicUrl" />
            <app-socials-button
                [variant]="'x'"
                [url]="topicUrl" />
            <app-socials-button
                [variant]="'email'"
                [url]="topicUrl" />
            <app-qrcode-button
                [link]="topicUrl"
                popupTitle="Topic QR code"
                [popupSubtitle]="qrCodePopupText()"
                [bannerTitle]="qrCodeBannerTitle()"
                [bannerSubtitle]="qrCodeBannerSubtitle()"
                [bannerIcon]="qrCodeBannerIcon()" />
        </ng-container>
    </div>
</ng-template>
