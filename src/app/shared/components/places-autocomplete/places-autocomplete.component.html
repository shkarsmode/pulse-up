<div class="places-autocomplete">
    <div class="places-autocomplete__wrap">
        <label
            id="search-location-label"
            for="search-location"
            class="visualy-hidden">
            Relevant Region (Optional)
        </label>

        <input
            #searchInput
            id="search-location"
            name="search"
            type="text"
            autocomplete="off"
            [formControl]="search"
            placeholder="Search city, address, or ZIP"
            class="places-autocomplete__input"
            role="combobox"
            aria-autocomplete="list"
            aria-controls="places-suggestions"
            (focus)="onFocus()"
            (blur)="onBlur()"
            (keydown)="onInputKeyDown($event)" />

        <svg-icon
            src="assets/svg/search.svg"
            class="places-autocomplete__icon" />

        <div class="places-autocomplete__right">
            @if (loading) {
                <app-spinner />
            } @else if (clearButtonVisible) {
                <button
                    type="button"
                    class="places-autocomplete__clear"
                    (click)="clear()">
                    <svg-icon src="assets/svg/close.svg" />
                </button>
            }
        </div>
    </div>

    @if (suggestionsVisible) {
        <ul
            id="places-suggestions"
            class="places-autocomplete__suggestions"
            role="listbox"
            (mousedown)="$event.preventDefault()">
            @for (suggestion of suggestions; track suggestion.id; let i = $index) {
                <li
                    id="suggestion-{{ i }}"
                    class="places-autocomplete__suggestion"
                    [class.is-active]="i === highlightedIndex"
                    role="option"
                    (mousedown)="selectSuggestion(suggestion)">
                    {{ suggestion.name }}
                </li>
            }
        </ul>
    }

    <div
        class="places-autocomplete__error"
        *ngIf="noResults && !loading">
        <small>No results, try a broader query</small>
    </div>
</div>
