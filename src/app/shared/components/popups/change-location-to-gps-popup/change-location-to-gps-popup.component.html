<div id="popup">
    <app-close-button 
        id="close"
        (handleClick)="onCloseDialog()" />

    @if (currentLocation()?.locationSource !== LocationSource.Gps) {
        <h1>Verify Your Location</h1>
        <h3>
            <strong>Your pulse matters!</strong>
            Crediting it to the right city makes it more accurate for decision-makers.
        </h3>
    
        <div class="location-wrap">
            <div>
                <svg-icon src="assets/svg/pulsed-from-gps.svg" />
            </div>
            <div>
                <span>Detected location:</span>
                <span>{{ currentLocation()?.details?.fullname }}</span>
                <span>IP detection can sometimes show the wrong city</span>
            </div>
        </div>

        <div class="button-title">
            For exact location:
        </div>

        <app-primary-button
            type="submit"
            [fullWidth]="true"
            [loading]="(geolocationService.status$ | async) === 'pending'"
            [disabled]="(geolocationService.status$ | async) === 'pending'"
            (handleClick)="enableLocationAccess()">
            Enable Location Access
        </app-primary-button>

        <div class="button-subtitle">
            Or use our mobile app for automatic GPS verification
        </div>
    } @else {
        <h1>Location Verified!</h1>
        <h3>
            <strong>Your pulse is credited to the exact right place.</strong>
        </h3>
    
        <h4>Decision-makers can see exactly where support is strongest.</h4>

        <div class="location-wrap location-wrap--success">
            <div>
                <svg-icon src="assets/svg/pulsed-from-gps.svg" />
            </div>
            <div>
                <span>Pulse location:</span>
                <span>{{ currentLocation()?.details?.fullname }}</span>
            </div>
        </div>

        <div class="you-all-set">
            You're all set! Your pulse has maximum impact. ðŸŽ‰
        </div>
    }

</div>