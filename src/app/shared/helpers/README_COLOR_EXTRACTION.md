# Image Color Extraction

Эта утилита автоматически извлекает доминирующие цвета из изображения и создает красивый градиентный фон.

## Использование

```typescript
import { extractBeautifulColorsFromImageUrl } from '@/app/shared/helpers/image-color-extractor';

const colors = await extractBeautifulColorsFromImageUrl(imageUrl);
console.log(colors.overlayGradientCss); // Готовый CSS градиент
```

## Возвращаемые значения

- `averageColor`: Средний цвет изображения (RGB)
- `vibrantColor`: Наиболее насыщенный цвет (RGB)
- `averageCss`: Средний цвет в формате CSS `rgb(r, g, b)`
- `vibrantCss`: Насыщенный цвет в формате CSS `rgb(r, g, b)`
- `overlayGradientCss`: Готовый CSS градиент для использования в качестве фона

## Как работает

1. Изображение загружается и масштабируется до 160px в ширину для оптимизации
2. Пиксели анализируются с шагом в 2 пикселя для скорости
3. Игнорируются почти белые (maxChannel > 245) и почти черные (maxChannel < 18) пиксели
4. Рассчитывается средний цвет всех пикселей
5. Находится наиболее насыщенный цвет с оптимальной яркостью (около 0.55)
6. Создается градиент от насыщенного цвета к среднему с полупрозрачностью

## CORS

Для работы с изображениями на других доменах требуется, чтобы сервер отправлял правильные CORS заголовки.
Изображение загружается с `crossOrigin = 'anonymous'`.

## Применение на странице топика

На странице топика ([topic.component.ts](../features/landing/pages/topic/topic.component.ts)) градиент применяется:

- В **classic режиме**: как полупрозрачный фон поверх контента
- В **landing режиме**: как оверлей поверх hero-изображения

Градиент автоматически пересчитывается при смене топика.
